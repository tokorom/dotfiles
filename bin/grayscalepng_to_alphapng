#/bin/sh

# grayscalepng_to_alphapng input.png output.png

if [ $# -ne 2 ]; then
  echo "SYNOPSIS\n    grayscalepng_to_alphapng [input.png] [output.png]"
  exit 1
fi

width=`mdls -name kMDItemPixelWidth $1 | cut -d " " -f 3`
height=`mdls -name kMDItemPixelHeight $1 | cut -d " " -f 3`

pngtopnm $1 > _temp.ppm
ppmtopgm _temp.ppm > _grayscale.pgm
ppmmake black $width $height > _black.pgm
pnminvert _grayscale.pgm > _invert.pgm
pnmtopng -alpha=_invert.pgm _black.pgm > $2

# clean
rm _temp.ppm 
rm _invert.pgm 
rm _black.pgm
rm _grayscale.pgm

